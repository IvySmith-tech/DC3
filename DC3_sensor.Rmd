---
title: "DC3_Sensor"
author: "Ivy Chen, Salwa Ouachtouki"
date: "3/19/2021"
output: html_document
---

1. combine two datasets(join)
2. find the highest Readings for each pollutant
look at the monitor, date find the corresponding wind speed and wind direction
3. Map(Sensor+factory)


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rio)
library(dplyr)
library(ggplot2)
library(lubridate)

sensordata <- import("Sensor Data.xlsx")
meteorologicaldata <- import ("Meteorological Data.xlsx")
monitor <- (sensordata$Monitor)

glimpse(sensordata)
class(sensordata$Chemical) 
```
```{r}
monitor_chemical_reading <- sensordata%>%
  count(Monitor, Chemical)
monitor_chemical_reading

linecolors <- c("#129376", "#FC7701", "#188D05", "#F40AF4")
fillcolors <- c("#93F4DE", "#F9A75E", "#C4F3BC", "F3BCF3")

ggplot(data = monitor_chemical_reading, aes(x = Monitor, y = n)) +
  geom_point(aes(shape = Chemical), alpha = 0.5, size = 3) + 
  theme(legend.position = "right") +
  ggtitle("Sensor Data: Monitors & Chemicals") +
  xlab("Monitor") + ylab("Amount of Chemical") +
  xlim("1", "2", "3","4","5","6","7","8","9") +
  scale_color_manual(values=linecolors) +
  scale_fill_manual(values=fillcolors) +
  theme_bw()

```

```{r}
chemical_reading <- sensordata %>% 
  group_by(Chemical, Reading) %>% 
  count(Chemical, Reading)
chemical_reading 

chemical_reading.sub1 <- subset(chemical_reading, Reading > .5)
chemical_reading.sub1

ggplot(data = chemical_reading.sub1, aes(x = Chemical, y = Reading)) +
  geom_point(color = "cornflowerblue") +
  scale_y_continuous(breaks = seq(0, 101, by = 1)) +
  theme(legend.position = "right") +
  ggtitle("Sensor Data: Chemical Reading") +
  xlab("Chemical") + ylab("Reading") +
  theme_bw()
```